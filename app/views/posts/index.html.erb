<% title "Blog" %>
<% description "RetirementPlan.io blog - Recent posts" %>

<div class='row large-top-padding'>

  <div class='col-md-3'>
    <%= render partial: 'posts/signup_widget' %>
    <%= render partial: 'posts/newsletter_widget' %>

    <div class='widget'>
      <h4 class='widget-title'><i class='fa fa-tags'>&nbsp;</i>Tags</h4>
      <ul class='widget-list'>
        <% Post.all_tags.each do |tag| %>
          <li><%= link_to tag.titleize, tags_path(tag) %></li>
        <% end %>
      </ul>
    </div>
  </div>

  <div class='col-md-9'>

    <% @posts.each do |post| %>

      <% cache(['blog', 'index', post]) do %>

        <div class='row post-loop'>

          <div class='col-md-2'>

            <div class='post-info text-muted'>
              <h4 class='author-name'>by <%= post.author %></h4>

              <p class='post-meta'>
                <i class='fa fa-calendar-o'>&nbsp;</i>
                <%= post.formatted_date %>
              </p>

              <% primary_tag = post.tags[0] %>
              <% if primary_tag %>
                <p class='post-meta'>
                  <i class='fa fa-archive'></i>
                  Filed under <%= link_to "#{primary_tag.titleize}", tags_path(primary_tag)%>
                </p>
              <% end %>

              <p class='post-meta'>
                <i class='fa fa-clock-o'></i>
                <%= reading_time(post.html) %>
              </p>

            </div> <!-- post-info -->

          </div> <!-- col-md-3 -->

          <div class='col-md-10 post-content'>
            <h2><%= link_to post.title, post.path %></h2>
            <p class='post-excerpt'><%= post.excerpt %></p>

            <p class='read-more'>
              <a href="<%= post.path %>" class='btn btn-default' title="Read More"><i class='fa fa-expand'></i>&nbsp;&nbsp;Read More</a>
            </p>

          </div>
        </div> <!-- row -->

      <% end #cache %>

    <% end # @posts.each %>

    <hr>

    <div class='text-center'>
      <%= paginate @posts, theme: 'twitter-bootstrap-3' %>
      <% content_for :head do %>
        <% # Generates rel='next/prev' to avoid duplicate content issues %>
        <%= rel_next_prev_link_tags @posts %>
      <% end %>
    </div>

  </div> <!-- col-md-9 -->
</div>
